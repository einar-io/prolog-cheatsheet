Einar's Prolog Cheatsheet
=========================
PLD2020



##### Fundamentals:

`halt.` or `Ctrl-D` Quit Prolog.

Queries and clauses must end with `.`.

Functions that take different number `n` of arguments (arity) are consideren distinct. 
They are are written with the suffix as `/n`:
E.g. `halt/0`, `help/1`, `listing/0`, `listing/1`, `=/2`.
The latter being infix. You can write `halt.` instead of `halt().` for `halt/0`.



Prolog uses the closed world assumption: if something cannot be proven, it is considered false.

https://en.wikipedia.org/wiki/Closed-world_assumption 

##### Help and documentaiton.
`help(F).` To learn about a function `F`. 
E.g. `help(help).`, `help(occurs).`, `help(append)`.

`appropos(function).`

A files are called "knowledge base", e.g. `myKB.pl`.

`[myKnowledgeBase]` loads a knowledge base.
`['myDir/mkb.pl']` same but with tab completion.

`listing.` List current knowledge base.
`listing(myPredicate)` List all rules for head `myPredicate`.


##### Syntax
`?-` Prompts you for a query. This happens in the interactive interpreter.
`:-` Is a rule constructor `<=`. This occurs only in the knowledge base files.

Variables start with capital letters or `_`.
Variables are instantiated as Prolog search for solutions (satisfying assignments).

more results ; or space

Constants: atoms or numbers


#####Rules

modus ponens: `p -> q /\ p => q`.
In math you write `p -> q` or `body -> head`.
In prolog you write `head :- body.` or `q :- p`.

You can read it as
"Head is true if Body is true"
Or: head _if_ body

#### Terms:
predicates are functions that return a boolean values
query
fact
predicate(args)    meaning predicate is true for args.
rule (head, body)
goals (in the body)
clause
atom        lowercase, 'sad asd s'
variable start with A or _. Autogenerated variables are usual _...
complex term (constructor/functor()) <functor>(<term1>,<term2>,...,<term>)
Files are called Knowledge Bases
Points in the search where there are several alternative ways of unifying a goal against the knowledge base are called choice points. 
backtracking
choice point

#### collections
###### Lists:
list: `[a,..,b]`
empty list: `[]`
head/tail: `[H|T]` head is an element, tail is a list.
###### Set, bags and more
Find unique solutions:
`setof(X, canRun(M), _ ).`
List of unique solutions:
`setof(X, canRun(X), L).`
cf. `bagof`, `findall`



##### Unsearchable operator names
1. `,` conjunction (and) see `help(,/2)`
2. `;` disjunction (or)  `help(;/2)`
3. `\+` negation with a caveat."Not-provable operator" is more appropriate. `help(\+/2)`
4. `\!` cut -- stops backtracking at this goal. `help(\!/2)`
5. `=` unify `tree(leaf(1),leaf(2)) = tree(T,B)`
6. unify two terms with `=/2`  (equal with two args)
7. `einar = X` see `help(=/2)`
8. `einar \= X` same as `\+ Term1 = term2` see `help(\=/2)`




##### Debugger
`trace.` trace next query.
`gtrace.`[visual tracer](https://www.swi-prolog.org/gtrace.html) trace next query in GUI.
`leash(+unify)`. "The special shorthand all refers to all ports, full refers to all ports except for the unify port (default)."

###### Usage:
step -> creep (space/return/c)
continue -> leap
Ctrl-C
spy
press h


#### error messagees:
singleton: varilabels: U are not constraining the variable. Add constraints or Use _ to ignore the variable.


```
Warning: /diku/pld-ta/git-repo/tombstone.pl:21:
	Clauses of program/1 are not together in the source-file
	  Earlier definition at /diku/pld-ta/git-repo/tombstone.pl:13
	  Current predicate: interpreter/2
	  Use :- discontiguous program/1. to suppress this message
```


#### Advanced
###### Occurs check and setting flags.

unify_with_occurs_check(X,X) :- acyclic_term(X).

?- current_prolog_flag(occurs_check,A).
A = false.

?- set_prolog_flag(occurs_check,true).
true.

?- current_prolog_flag(occurs_check,A).
A = true.

?- unify_with_occurs_check(father(X), X).
false.



#### Unknown
reset: knowledge /rules

autorun query on load
